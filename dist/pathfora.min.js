"use strict";!function(e,t){var i,a,o,n,s,r={modal:"",slideout:"bottom-left",button:"top-left",bar:"top-absolute",folding:"bottom-left"},l={generic:{className:"pathfora",headline:"",theme:"default",themes:{"default":{background:"#f1f1f1",headline:"#444",text:"#888",close:"#bbb",actionText:"#444",actionBackground:"#fff",cancelText:"#bbb",cancelBackground:"#f1f1f1"},dark:{background:"#333",headline:"#fefefe",text:"#aaa",close:"#888",actionText:"#fff",actionBackground:"#444",cancelText:"#888",cancelBackground:"#333"},light:{background:"#f1f1f1",headline:"#444",text:"#888",close:"#bbb",actionText:"#444",actionBackground:"#fff",cancelText:"#bbb",cancelBackground:"#f1f1f1"}},displayConditions:{showOnInit:!0,showDelay:0,hideAfter:0,displayWhenElementVisible:"",scrollPercentageToDisplay:0}},message:{layout:"modal",position:"",variant:"1",okMessage:"Confirm",cancelMessage:"Cancel",okShow:!0,cancelShow:!0},subscription:{layout:"modal",position:"",variant:"1",placeholders:{email:"Email"},okMessage:"Confirm",cancelMessage:"Cancel",okShow:!0,cancelShow:!0},form:{layout:"modal",position:"",variant:"1",placeholders:{name:"Name",title:"Title",email:"Email",message:"Message"},required:{name:!0,email:!0},fields:{},okMessage:"Send",okShow:!0,cancelMessage:"Cancel",cancelShow:!0,showSocialLogin:!1},sitegate:{layout:"modal",position:"",variant:"1",placeholders:{name:"Name",email:"Email",organization:"Organization",title:"Title"},required:{name:!0,email:!0},fields:{},okMessage:"Submit",okShow:!0,cancelShow:!0,cancelMessage:"Cancel",showSocialLogin:!1,showForm:!0}},d={message:{modal:'<div class="pf-widget-container"><div class="pf-va-middle"><div class="pf-widget-content"><a class="pf-widget-close">&times;</a><h2 class="pf-widget-headline"></h2><div class="pf-widget-body"><div class="pf-va-middle"><p class="pf-widget-message"></p><a class="pf-content-unit"></a><a class="pf-widget-btn pf-widget-ok">Confirm</a><a class="pf-widget-btn pf-widget-cancel">Cancel</a></div></div></div></div></div>',slideout:'<a class="pf-widget-close">&times;</a><div class="pf-widget-body"></div><div class="pf-widget-content"><h2 class="pf-widget-headline"></h2><p class="pf-widget-message"></p><a class="pf-content-unit"></a><a class="pf-widget-btn pf-widget-ok">Confirm</a><a class="pf-widget-btn pf-widget-cancel">Cancel</a></div>',bar:'<a class="pf-widget-body"></a><a class="pf-widget-close">&times;</a><div class="pf-bar-content"><p class="pf-widget-message"></p><a class="pf-widget-btn pf-widget-ok">Confirm</a><a class="pf-widget-btn pf-widget-cancel">Cancel</a></div>',button:'<p class="pf-widget-message pf-widget-ok"></p>',inline:'<div class="pf-widget-container"><div class="pf-va-middle"><div class="pf-widget-content"><a class="pf-widget-close">&times;</a><h2 class="pf-widget-headline"></h2><div class="pf-widget-body"><div class="pf-va-middle"><p class="pf-widget-message"></p><a class="pf-widget-btn pf-widget-ok">Confirm</a><a class="pf-widget-btn pf-widget-cancel">Cancel</a></div></div></div></div></div>'},subscription:{modal:'<div class="pf-widget-container"><div class="pf-va-middle"><div class="pf-widget-content"><a class="pf-widget-close">&times;</a><h2 class="pf-widget-headline"></h2><div class="pf-widget-body"><div class="pf-va-middle"><p class="pf-widget-message"></p><form><button type="submit" class="pf-widget-btn pf-widget-ok">X</button><span><input name="email" type="email" required></span></form></div></div></div></div></div>',slideout:'<a class="pf-widget-close">&times;</a><div class="pf-widget-body"></div><div class="pf-widget-content"><h2 class="pf-widget-headline"></h2><p class="pf-widget-message"></p><form><button type="submit" class="pf-widget-btn pf-widget-ok">X</button><span><input name="email" type="email" required></span></form></div>',folding:'<a class="pf-widget-caption"><p class="pf-widget-headline"></p><span>&rsaquo;</span></a><a class="pf-widget-caption-left"><p class="pf-widget-headline"></p><span>&rsaquo;</span></a><div class="pf-widget-body"></div><div class="pf-widget-content"><p class="pf-widget-message"></p><form><button type="submit" class="pf-widget-btn pf-widget-ok">X</button><span><input name="email" type="email" required></span></form></div>',bar:'<div class="pf-widget-body"></div><a class="pf-widget-close">&times;</a><div class="pf-bar-content"><p class="pf-widget-message"></p><form><input name="email" type="email" required><input type="submit" class="pf-widget-btn pf-widget-ok" /></form></div>',inline:'<div class="pf-widget-container"><div class="pf-va-middle"><div class="pf-widget-content"><a class="pf-widget-close">&times;</a><h2 class="pf-widget-headline"></h2><div class="pf-widget-body"><div class="pf-va-middle"><p class="pf-widget-message"></p><form><button type="submit" class="pf-widget-btn pf-widget-ok">X</button><span><input name="email" type="email" required></span></form></div></div></div></div></div>'},form:{modal:'<div class="pf-widget-container"><div class="pf-va-middle"><div class="pf-widget-content"><a class="pf-widget-close">&times;</a><h2 class="pf-widget-headline"></h2><div class="pf-widget-body"><div class="pf-va-middle"><p class="pf-widget-message"></p><div class="pf-social-login"><p name="fb-login" hidden></p><p name="google-login" hidden></p></div><form><input name="username" type="text"><input name="title" type="text"><input name="email" type="email"><textarea name="message" rows="5"></textarea><button type="submit" class="pf-widget-btn pf-widget-ok">Send</button><button class="pf-widget-btn pf-widget-cancel">Cancel</button></form></div></div></div></div></div>',slideout:'<a class="pf-widget-close">&times;</a><div class="pf-widget-body"></div><div class="pf-widget-content"><h2 class="pf-widget-headline"></h2><p class="pf-widget-message"></p><div class="pf-social-login"><p name="fb-login" hidden></p><p name="google-login" hidden></p></div><form><input name="username" type="text"><input name="title" type="text"><input name="email" type="email"><textarea name="message" rows="5"></textarea> <button type="submit" class="pf-widget-btn pf-widget-ok">Send</button><button class="pf-widget-btn pf-widget-cancel">Cancel</button></form></div>',folding:'<a class="pf-widget-caption"><p class="pf-widget-headline"></p><span>&rsaquo;</span></a><a class="pf-widget-caption-left"><p class="pf-widget-headline"></p><span>&rsaquo;</span></a><div class="pf-widget-body"></div><div class="pf-widget-content"><p class="pf-widget-message"></p><div class="pf-social-login"><p name="fb-login" hidden></p><p name="google-login" hidden></p></div><form><input name="username" type="text"></p><input name="title" type="text"><input name="email" type="email"><textarea  name="message" rows="5"></textarea> <button class="pf-widget-btn pf-widget-cancel">Cancel</button><button type="submit" class="pf-widget-btn pf-widget-ok">Send</button> </form></div>',inline:'<div class="pf-widget-container"><div class="pf-va-middle"><div class="pf-widget-content"><a class="pf-widget-close">&times;</a><h2 class="pf-widget-headline"></h2><div class="pf-widget-body"><div class="pf-va-middle"><p class="pf-widget-message"></p><div class="pf-social-login"><p name="fb-login" hidden></p><p name="google-login" hidden></p></div><form><input name="username" type="text"><input name="title" type="text"><input name="email" type="email"><textarea name="message" rows="5"></textarea><button type="submit" class="pf-widget-btn pf-widget-ok">Send</button><button class="pf-widget-btn pf-widget-cancel">Cancel</button></form></div></div></div></div></div>'},sitegate:{modal:'<div class="pf-widget-container"><div class="pf-va-middle"><div class="pf-widget-content"><h2 class="pf-widget-headline"></h2><div class="pf-widget-body"><div class="pf-va-middle"><p class="pf-widget-message"></p><div class="pf-sitegate-social-plugins pf-social-login"><p name="fb-login" hidden></p><p name="google-login" hidden></p></div><form><input class="pf-sitegate-field pf-field-full-width" name="username" type="text"><input class="pf-sitegate-field pf-field-full-width" name="email" type="email"><input class="pf-sitegate-field pf-field-half-width" name="organization" type="text"><input class="pf-sitegate-field pf-field-half-width" name="title" type="text"><div class="pf-sitegate-clear"></div><button type="submit" class="pf-widget-btn pf-widget-ok">Submit</button><button type="reset" class="pf-widget-btn pf-widget-cancel">Cancel</button></form></div></div></div></div></div>',inline:'<div class="pf-widget-container"><div class="pf-va-middle"><div class="pf-widget-content"><h2 class="pf-widget-headline"></h2><div class="pf-widget-body"><div class="pf-va-middle"><p class="pf-widget-message"></p><div class="pf-sitegate-social-plugins pf-social-login"><p name="fb-login" hidden></p><p name="google-login" hidden></p></div><form><input class="pf-sitegate-field pf-field-full-width" name="username" type="text"><input  class="pf-sitegate-field pf-field-full-width" name="email" type="email"><input class="pf-sitegate-field pf-field-half-width" name="organization" type="text"><input class="pf-sitegate-field pf-field-half-width" name="title" type="text"><div class="pf-sitegate-clear"></div><button type="submit" class="pf-widget-btn pf-widget-ok">Submit</button><button type="reset" class="pf-widget-btn pf-widget-cancel">Cancel</button></form></div></div></div></div></div>'},social:{facebookIcon:'<div class="fb-login-button" data-max-rows="1" data-size="large" data-show-faces="false" data-auto-logout-link="true" data-scope="public_profile,email" data-onlogin="window.pathfora.onFacebookSignIn();"></div>',googleMeta:'<meta name="google-signin-client_id" content="{{google-clientId}}">',googleIcon:'<div id="{{google-btnId}}" class="google-login"></div>'}},c={INIT:"widgetInitialized",LOAD:"widgetLoaded",CLICK:"buttonClicked",FORM_SUBMIT:"formSubmitted",MODAL_OPEN:"modalOpened",MODAL_CLOSE:"modalClosed"},f=function(){var e,t,i,a,o=[];for(a=arguments.length,i=0;a>i;i++)o.push(arguments[i]);return e=o.reduce(function(e,t){return e+t}),e>1&&(t=1/e,o=o.map(function(e){return e*t})),{groups:o,groupsNumber:o.length}},p="187ef4436122d1cc2f40dc2b92f0eba0",g={100:f(100),"50/50":f(50,50),"80/20":f(80,20)},u={pageViews:0,timeSpentOnPage:0,closedWidgets:[],completedActions:[],cancelledActions:[],displayedWidgets:[],abTestingGroups:[],socialNetworks:{}},m=function(){var e,i;e=t.getElementsByTagName("head")[0],i=t.createElement("link"),i.setAttribute("rel","stylesheet"),i.setAttribute("type","text/css"),i.setAttribute("href","//c.lytics.io/static/pathfora.min.css"),e.appendChild(i)};a={hasClass:function(e,t){return new RegExp("(^| )"+t+"( |$)","gi").test(e.className)},addClass:function(e,t){this.removeClass(e,t),e.className=[e.className,t].join(" ")},removeClass:function(e,t){var i=new RegExp(["(^|\\b)",t.split(" ").join("|"),"(\\b|$)"].join(""),"gi");e.className=e.className.replace(i," ")},readCookie:function(e){var i=t.cookie,a=i.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return a?a.pop():null},saveCookie:function(t,i,a){var o;o=a?"; expires="+a.toUTCString():"",e.document.cookie=[t,"=",i,o,"; path = /"].join("")},generateUniqueId:function(){var e;return"undefined"==typeof e&&(e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}),[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},initWidgetScaffold:function(){return{target:[],exclude:[],inverse:[]}},insertWidget:function(e,t,i,a){var o,n=!0;if(!a.target)throw new Error("Invalid scaffold. No target array.");if(!a.exclude)throw new Error("Invalid scaffold. No exclude array.");if(!a.inverse)throw new Error("Invalid scaffold. No inverse array.");if("target"===e)o=a.target;else{if("exclude"!==e)throw new Error("Invalid method ("+e+").");o=a.exclude}for(var s=0;s<o.length;s++){var r=o[s];r.segment===t&&(r.widgets.push(i),n=!1)}n&&o.push({segment:t,widgets:[i]})}},o={delayedWidgets:{},openedWidgets:[],initializedWidgets:[],watchers:[],expiration:null,valid:!0,pageViews:~~a.readCookie("PathforaPageView"),initializeWidget:function(i){var n,s=i.displayConditions;if(o.valid=!0,o.expiration=new Date,o.expiration.setDate(o.expiration.getDate()+365),i.pushDown){if("bar"!==i.layout||"top-fixed"!==i.position&&"top-absolute"!==i.position)throw new Error("Only top positioned bar widgets may have a pushDown property");a.addClass(t.querySelector(i.pushDown),"pf-push-down")}s.date&&(o.valid=o.valid&&o.dateChecker(s.date,i)),s.displayWhenElementVisible&&(n=o.registerElementWatcher(s.displayWhenElementVisible,i),o.watchers.push(n),o.initializeScrollWatchers(o.watchers,i)),s.scrollPercentageToDisplay&&(n=o.registerPositionWatcher(s.scrollPercentageToDisplay,i),o.watchers.push(n),o.initializeScrollWatchers(o.watchers,i)),s.pageVisits&&(o.valid=o.valid&&o.pageVisitsChecker(s.pageVisits,i)),s.hideAfterAction&&(o.valid=o.valid&&o.hideAfterActionChecker(s.hideAfterAction,i)),s.urlContains&&(o.valid=o.valid&&o.urlChecker(s.urlContains,i)),o.valid=o.valid&&s.showOnInit,0===o.watchers.length&&(s.impressions&&(o.valid=o.valid&&o.impressionsChecker(s.impressions,i)),o.valid&&e.pathfora.showWidget(i))},initializeScrollWatchers:function(t,i){return o.scrollListener||(o.scrollListener=function(){var a,n;for(a in t)t.hasOwnProperty(a)&&null!==t[a]&&(n=o.valid&&t[a].check());i.displayConditions.impressions&&n&&(n=o.impressionsChecker(condition.impressions,i)),n&&e.pathfora.showWidget(i)},"function"==typeof e.addEventListener?e.addEventListener("scroll",o.scrollListener,!1):e.onscroll=o.scrollListener),!0},pageVisitsChecker:function(e,t){return o.pageViews>=e},urlChecker:function(e,t){var i=window.location.href,a=window.location.hostname+window.location.pathname,o=!1;return e instanceof Array||(e=Object.keys(e).map(function(t){return e[t]})),-1===e.indexOf("*")?e.forEach(function(e){switch(typeof e){case"string":-1!==i.indexOf(e)&&(o=!0);break;case"object":if(e.match&&e.value)switch(e.match){case"simple":a===e.value&&(o=!0);break;case"exact":i===e.value&&(o=!0);break;case"regex":var t=new RegExp(e.value);t.test(i)&&(o=!0);break;default:-1!==i.indexOf(e.value)&&(o=!0)}else console.log("invalid display conditions");break;default:console.log("invalid display conditions")}}):o=!0,o},dateChecker:function(e,t){var i=!0,a=Date.now();return e.start_at&&a<new Date(e.start_at).getTime()&&(i=!1),e.end_at&&a>new Date(e.end_at).getTime()&&(i=!1),i},impressionsChecker:function(e,t){var i,n,s=!0,r="PathforaImpressions_"+t.id,l=~~sessionStorage.getItem(r),d=a.readCookie(r),c=Date.now();return l?l+=1:l=1,d?(i=d.split("|"),n=parseInt(i[0])+1,i=1===i.length?d.split(","):i,"undefined"!=typeof i[1]&&Math.abs(i[1]-c)/1e3<e.buffer&&(s=!1)):n=1,(l>e.session||n>e.total)&&(s=!1),s&&o.valid&&(sessionStorage.setItem(r,l),a.saveCookie(r,Math.min(n,9998)+"|"+c,o.expiration)),s},hideAfterActionChecker:function(e,t){var i=!0,o=Date.now(),n=a.readCookie("PathforaConfirm_"+t.id),s=a.readCookie("PathforaCancel_"+t.id),r=a.readCookie("PathforaClosed_"+t.id);if(e.confirm&&n){var l=n.split("|");l=1===l.length?n.split(","):l,parseInt(l[0])>=e.confirm.hideCount&&(i=!1),"undefined"!=typeof l[1]&&Math.abs(l[1]-o)/1e3<e.confirm.duration&&(i=!1)}if(e.cancel&&s){var l=s.split("|");l=1===l.length?s.split(","):l,parseInt(l[0])>=e.cancel.hideCount&&(i=!1),"undefined"!=typeof l[1]&&Math.abs(l[1]-o)/1e3<e.cancel.duration&&(i=!1)}if(e.closed&&r){var l=r.split("|");l=1===l.length?r.split(","):l,parseInt(l[0])>=e.closed.hideCount&&(i=!1),"undefined"!=typeof l[1]&&Math.abs(l[1]-o)/1e3<e.closed.duration&&(i=!1)}return i},removeScrollWatchers:function(t){t.forEach(function(e){o.removeWatcher(e)}),e.removeEventListener("scroll",o.scrollListener,!1)},registerDelayedWidget:function(e){this.delayedWidgets[e.id]=setTimeout(function(){o.initializeWidget(e)},1e3*e.displayConditions.showDelay)},cancelDelayedWidget:function(e){var t=this.delayedWidgets[e.id];t&&(clearTimeout(t),delete this.delayedWidgets[e.id])},registerPositionWatcher:function(e,i){var a={check:function(){var i=(t.body.offsetHeight-window.innerHeight)*e/100,n=t.documentElement.scrollTop||t.body.scrollTop;return n>=i?(o.removeWatcher(a),!0):!1}};return a},registerElementWatcher:function(e,i){var a={elem:t.querySelector(e),check:function(){var e=t.body.scrollTop||t.documentElement.scrollTop,i=window.innerHeight+e>=t.body.offsetHeight;return a.elem.offsetTop-window.innerHeight/2<=e||i?(o.removeWatcher(a),!0):!1}};return a},removeWatcher:function(e){var t;for(t in o.watchers)o.watchers.hasOwnProperty(t)&&e===o.watchers[t]&&o.watchers.splice(t,1)},constructWidgetLayout:function(e,i){var a,n,s,r=e.querySelector(".pf-widget-cancel"),l=e.querySelector(".pf-widget-ok"),d=(e.querySelector("form"),e.querySelectorAll(".pf-widget-headline")),c=e.querySelector(".pf-widget-body"),f=e.querySelector(".pf-widget-message"),p=e.querySelector(".pf-widget-close"),g=e.querySelector(".pf-content-unit");switch((null!==r&&!i.cancelShow||"inline"===i.layout)&&(n=r,n.parentNode&&n.parentNode.removeChild(n)),"inline"===i.layout&&(n=p,n.parentNode&&n.parentNode.removeChild(n)),null===l||i.okShow||(n=l,n.parentNode&&n.parentNode.removeChild(n)),null!==r&&(r.innerHTML=i.cancelMessage),null!==l&&(l.innerHTML=i.okMessage),l&&null!==l.value&&(l.value=i.okMessage),r&&null!==r.value&&(r.value=i.cancelMessage),i.type){case"form":switch(i.layout){case"folding":case"modal":case"slideout":case"random":case"inline":o.autoCompleteFacebookData(),o.autoCompleteGoogleData();break;default:throw new Error("Invalid widget layout value")}break;case"subscription":switch(i.layout){case"folding":case"modal":case"bar":case"slideout":case"random":case"inline":break;default:throw new Error("Invalid widget layout value")}break;case"message":switch(i.layout){case"modal":case"slideout":if(i.recommend&&i.content&&Object.keys(i.content).length>0){var u=i.content[0];g.href=u.url;var m=t.createElement("div");m.className="pf-content-unit-img",m.style.backgroundImage="url('"+u.image+"')",g.appendChild(m);var h=t.createElement("div");h.className="pf-content-unit-meta";var w=t.createElement("h4");w.innerHTML=u.title,h.appendChild(w);var v=t.createElement("p");v.innerHTML=u.description,h.appendChild(v),g.appendChild(h)}break;case"random":case"bar":case"button":case"inline":break;default:throw new Error("Invalid widget layout value")}break;case"sitegate":switch(i.layout){case"modal":case"inline":i.showForm===!1&&(n=e.querySelector("form"),n&&(n.className+=" pf-hidden"),n=e.querySelector(".pf-sitegate-centered-label"),n.parentNode&&n.parentNode.removeChild(n));break;default:throw new Error("Invalid widget layout value")}}for(s=d.length-1;s>=0;s--)d[s].innerHTML=i.headline;switch(i.image&&("button"===i.layout||(a=t.createElement("img"),a.src=i.image,a.className="pf-widget-img",c.appendChild(a))),i.type){case"sitegate":case"form":i.showSocialLogin===!1?(n=e.querySelector(".pf-social-login"),n&&n.parentNode&&n.parentNode.removeChild(n)):(o.autoCompleteFacebookData(),o.autoCompleteGoogleData());var y=function(t){return"message"===t?e.querySelector("textarea"):"name"===t?e.querySelector('input[name="username"]'):e.querySelector('input[name="'+t+'"]')};Object.keys(i.placeholders).forEach(function(e){var t=y(e);t&&"undefined"!=typeof t.placeholder&&(t.placeholder=i.placeholders[e])}),Object.keys(i.required).forEach(function(e){var t=y(e);t&&i.required[e]&&t.setAttribute("required","")}),Object.keys(i.fields).forEach(function(e){var t=y(e);if(t&&!i.required[e]&&!i.fields[e]){var a=t.parentNode;a&&a.removeChild(t)}});break;case"subscription":e.querySelector("input").placeholder=i.placeholders.email}i.msg&&(f.innerHTML=i.msg)},constructWidgetActions:function(t,i){var n,s,r,l,d,f,p,g,u,m,h,w=t.querySelector(".pf-widget-ok"),v=!0;switch(i.type){case"form":case"sitegate":d=t.querySelector("form"),f=function(e){var a;switch(e.preventDefault(),i.type){case"form":a="submit";break;case"subscription":a="subscribe";break;case"sitegate":a="unlock",v=!1}a&&o.trackWidgetAction(a,i,e.target),"function"==typeof i.onSubmit&&i.onSubmit(c.FORM_SUBMIT,{widget:t,event:e,data:Array.prototype.slice.call(d.querySelectorAll("input, textarea")).map(function(e){return{name:e.name||e.id,value:e.value}})})},d.addEventListener?d.addEventListener("submit",f):d.attachEvent("submit",f)}switch(i.layout){case"folding":for(v=!1,n=t.querySelectorAll(".pf-widget-caption, .pf-widget-caption-left"),s=t.querySelector(".pf-widget-caption"),"left"!==i.position&&setTimeout(function(){var e=t.offsetHeight-s.offsetHeight;t.style.bottom=-e+"px"},0),h=n.length-1,m=h;m>=0;m--)n[m].onclick=function(){a.hasClass(t,"opened")?a.removeClass(t,"opened"):a.addClass(t,"opened")};break;case"button":"function"==typeof i.onClick&&(p=function(e){i.onClick(c.CLICK,{widget:t,event:e})});break;case"modal":case"slideout":case"bar":case"inline":r=t.querySelector(".pf-widget-cancel"),l=t.querySelector(".pf-widget-close"),g=function(e){"function"==typeof i.onModalClose&&i.onModalClose(c.MODAL_CLOSE,{widget:t,event:e})},u=function(e){var t,i=a.readCookie(e),n=Date.now();i?(i=i.split("|"),i=1===i.length?i.split(","):i,t=Math.min(parseInt(i[0]),9998)+1):t=1,a.saveCookie(e,t+"|"+n,o.expiration)},l&&(l.onclick=function(i){e.pathfora.closeWidget(t.id),u("PathforaClosed_"+t.id),g(i)}),r&&("object"==typeof i.cancelAction?r.onclick=function(a){o.trackWidgetAction("cancel",i),"function"==typeof i.cancelAction.callback&&i.cancelAction.callback(),"reset"!==r.type&&e.pathfora.closeWidget(t.id,!0),u("PathforaCancel_"+t.id),g(a)}:r.onclick=function(a){o.trackWidgetAction("cancel",i),"reset"!==r.type&&e.pathfora.closeWidget(t.id),u("PathforaCancel_"+t.id),g(a)})}"object"==typeof i.confirmAction?w.onclick=function(){o.trackWidgetAction("confirm",i),"function"==typeof u&&u("PathforaConfirm_"+t.id),"function"==typeof i.confirmAction.callback&&i.confirmAction.callback(),"function"==typeof p&&p(event),"function"==typeof g&&g(event),"inline"!==i.layout&&e.pathfora.closeWidget(t.id,!0)}:"message"===i.type?w.onclick=function(){o.trackWidgetAction("confirm",i),"function"==typeof u&&u("PathforaConfirm_"+t.id),"function"==typeof p&&p(event),"inline"!==i.layout&&e.pathfora.closeWidget(t.id)}:("form"===i.type||"sitegate"===i.type)&&(w.onclick=function(){var a=!0;Array.prototype.slice.call(t.querySelectorAll("input, textarea")).forEach(function(e){e.hasAttribute("required")&&!e.value&&(a=!1)}),a&&("function"==typeof u&&u("PathforaConfirm_"+t.id),"function"==typeof g&&g(event),"inline"!==i.layout&&e.pathfora.closeWidget(t.id))})},setupWidgetColors:function(e,t){var i={};"undefined"==typeof t.theme&&o.setCustomColors(e,l.generic.themes["default"]),t.config&&null===t.config.theme?(o.updateObject(i,l.generic.themes["default"]),o.updateObject(i,t.config.colors),o.setCustomColors(e,i)):t.themes&&("custom"===t.theme?o.updateObject(i,t.colors):"default"===t.theme&&"default"!==l.generic.theme?"custom"===l.generic.theme?o.updateObject(i,l.generic.colors):o.updateObject(i,l.generic.themes[l.generic.theme]):o.updateObject(i,l.generic.themes[t.theme]),o.setCustomColors(e,i))},setWidgetClassname:function(e,t){e.className=["pf-widget ","pf-"+t.type," pf-widget-"+t.layout,t.position?" pf-position-"+t.position:"",t.pushDown?" pf-has-push-down":"",t.origin?" pf-origin-"+t.origin:""," pf-widget-variant-"+t.variant,t.theme?" pf-theme-"+t.theme:"",t.className?" "+t.className:""].join("")},validateWidgetPosition:function(e,t){var i;switch(t.layout){case"modal":i=[""];break;case"slideout":i=["bottom-left","bottom-right"];break;case"bar":i=["top-absolute","top-fixed","bottom-fixed"];break;case"button":i=["left","right","top-left","top-right","bottom-left","bottom-right"];break;case"folding":i=["left","bottom-left","bottom-right"];break;case"inline":i=[]}-1===i.indexOf(t.position)},setupWidgetPosition:function(e,t){t.position?this.validateWidgetPosition(e,t):t.position=r[t.layout]},createWidgetHtml:function(e){var i=t.createElement("div");return i.innerHTML=d[e.type][e.layout]||"",i.id=e.id,this.setupWidgetPosition(i,e),this.constructWidgetActions(i,e),this.setWidgetClassname(i,e),this.constructWidgetLayout(i,e),this.setupWidgetColors(i,e),i},trackTimeOnPage:function(){o.tickHandler=setInterval(function(){u.timeSpentOnPage+=1},1e3)},checkIfUserJustEntered:function(){return a.readCookie("PathforaInit")?!1:(a.saveCookie("PathforaInit",!0,o.expiration),!0)},setCustomColors:function(e,t){var i,o,n=e.querySelector(".pf-widget-close"),s=e.querySelector(".pf-widget-headline"),r=e.querySelector(".pf-widget-caption-left .pf-widget-headline"),l=e.querySelector(".pf-widget-cancel"),d=e.querySelector(".pf-widget-ok"),c=e.querySelector(".pf-widget-caption span"),f=e.querySelector(".pf-widget-caption-left span"),p=e.querySelector(".pf-content-unit"),g=e.querySelector(".pf-content-unit-meta"),u=e.querySelectorAll("input, textarea");if(a.hasClass(e,"pf-widget-modal")?e.querySelector(".pf-widget-content").style.backgroundColor=t.background:e.style.backgroundColor=t.background,u.length>0)for(o=u.length,i=0;o>i;i++)u[i].style.backgroundColor=t.fieldBackground;g&&(p.style.backgroundColor=t.actionBackground,g.querySelector("h4").style.color=t.actionText,g.querySelector("p").style.color=t.text),n&&(n.style.color=t.close),s&&(s.style.color=t.headline),r&&(r.style.color=t.headline),c&&(c.style.color=t.close),f&&(f.style.color=t.close),l&&(l.style.color=t.cancelText,l.style.backgroundColor=t.cancelBackground),d&&(d.style.color=t.actionText,d.style.backgroundColor=t.actionBackground),e.querySelector(".pf-widget-message").style.color=t.text},trackWidgetAction:function(e,t,i){var s={"pf-widget-id":t.id,"pf-widget-type":t.type,"pf-widget-layout":t.layout,"pf-widget-variant":t.variant},r=!0;switch(e){case"show":u.displayedWidgets.push(s);break;case"close":u.closedWidgets.push(s);break;case"confirm":s["pf-widget-action"]=!!t.confirmAction&&t.confirmAction.name||"default confirm",u.completedActions.push(s);break;case"cancel":s["pf-widget-action"]=!!t.cancelAction&&t.cancelAction.name||"default cancel",u.cancelledActions.push(s);break;case"submit":for(var l in i.children){var d=i.children[l];if("undefined"!=typeof d.getAttribute&&null!==d.getAttribute("name")){var c=d.getAttribute("name");s["pf-form-"+c]=d.value}}break;case"subscribe":s["pf-form-email"]=i.elements.email.value;case"unlock":for(var l in i.children){var d=i.children[l];if("undefined"!=typeof d.getAttribute&&null!==d.getAttribute("name")){var c=d.getAttribute("name");s["pf-form-"+c]=d.value}"undefined"!=typeof d.hasAttribute&&d.hasAttribute("required")&&!s["pf-form-"+c]&&(d.setAttribute("invalid",""),r=!1)}a.saveCookie("PathforaUnlocked",r,o.expiration)}s["pf-widget-event"]=e,r===!0&&n.reportData(s)},updateObject:function(e,t){var i;for(i in t)"object"==typeof t[i]&&null!==t[i]?t.hasOwnProperty(i)&&("undefined"==typeof e[i]&&(e[i]={}),o.updateObject(e[i],t[i])):t.hasOwnProperty(i)&&(e[i]=t[i])},initializeWidgetArray:function(e,t){var i,s,r,d,f,p;for(p=e.length,f=0;p>f;f++)if(d=e[f],d&&d.config&&(i=d.config.onInit,s=l[d.type],r=l.generic,("sitegate"!==d.type||"true"!==a.readCookie("PathforaUnlocked"))&&d.hiddenViaABTests!==!0)){if(!(this.initializedWidgets.indexOf(d.id)<0))throw new Error("Cannot add two widgets with the same id");this.initializedWidgets.push(d.id),this.updateObject(d,r),this.updateObject(d,s),this.updateObject(d,d.config);var g=function(e){e.displayConditions.showDelay?o.registerDelayedWidget(e):o.initializeWidget(e)};if("message"===d.type&&d.recommend){if("slideout"!==d.layout&&"modal"!==d.layout)throw new Error("Unsupported layout for content recommendation");var u;if(d.content&&d.content[0]){if(!d.content[0]["default"])throw new Error("Cannot define recommended content unless it is a default");u=d.content[0]}n.recommendContent(t,d.recommend.ql.raw,function(e){var t=[];if(e)t.push({title:e.title,description:e.description,url:"http://"+e.url,image:e.primary_image});else{if(!u)throw new Error("Could not get recommendation and no default defined");t.push(u)}d.content=t,g(d)})}else g(d);"function"==typeof i&&i(c.INIT,{widget:d})}},validateWidgetsObject:function(e){var t,i;if(!e)throw new Error("Widgets not specified");if(!(e instanceof Array)&&e.target)for(i=e.target.length,e.common=e.common||[],t=0;i>t;t++){if(!e.target[t].segment)throw new Error("All targeted widgets should have segment specified");"*"===e.target[t].segment&&(e.common=e.common.concat(e.target[t].widgets),e.target.splice(t,1))}},prepareWidget:function(e,t){var i,o,n={};if(!t)throw new Error("Config object is missing");if("random"===t.layout){switch(i={layout:["modal","slideout","bar","folding"],variant:["1","2"],slideout:["bottom-left","bottom-right"],bar:["top-absolute","top-fixed","bottom-fixed"],folding:["left","bottom-left","bottom-right"]},e){case"message":o=Math.floor(4*Math.random()),t.layout=i.layout[o];break;case"subscription":for(o=Math.floor(5*Math.random());3===o;)o=Math.floor(5*Math.random());t.layout=i.layout[o];break;case"form":for(o=Math.floor(5*Math.random());2===o||3===o;)o=Math.floor(5*Math.random());t.layout=i.layout[o]}switch(t.layout){case"folding":t.position=i.folding[Math.floor(3*Math.random())],t.variant=i.variant[Math.floor(2*Math.random())];break;case"slideout":t.position=i.slideout[Math.floor(2*Math.random())],t.variant=i.variant[Math.floor(2*Math.random())];break;case"modal":t.variant=i.variant[Math.floor(2*Math.random())],t.position="";break;case"bar":t.position=i.bar[Math.floor(3*Math.random())];break;case"inline":t.position="body"}}if(n.type=e,n.config=t,!t.id&&t.displayConditions&&"undefined"!=typeof t.displayConditions.impressions)throw delete t.displayConditions.impressions,new Error("Widgets with the impression displayConditions need a preset id value. Display condition denied.");if(!t.id&&t.displayConditions&&"undefined"!=typeof t.displayConditions.hideAfterAction)throw delete t.displayConditions.hideAfterAction,new Error("Widgets with the hideAfterAction displayConditions need a preset id value. Display condition denied.");return n.id=t.id||a.generateUniqueId(),n},prepareABTest:function(e){var t={};if(!e)throw new Error("Config object is missing");if(t.id=e.id,t.cookieId=p+e.id,t.groups=e.groups,!g[e.type])throw new Error("Unknown AB testing type: "+e.type);return t.type=g[e.type],t},requestSocialPluginRender:function(){var e={facebook:[],google:[]},t={},i=function(){return"undefined"!=typeof window.FB&&"function"==typeof window.FB.XFBML.parse?(e.facebook.forEach(function(e){var t=e.querySelector(".fb-login-button");window.FB.XFBML.parse(e),t.className+=" social-login-btn"}),e.facebook=[],o.autoCompleteFacebookData(),clearTimeout(t.fb)):setTimeout(i,1e3)},a=function(){return"undefined"!=typeof window.gapi?(e.google.forEach(function(e){var t=e.querySelector(".google-login");window.gapi.signin2.render(t.id,{scope:"profile",onsuccess:pathfora.onGoogleSignIn,height:25,width:90,longtitle:!1}),t.className+=" social-login-btn"}),e.google=[],clearTimeout(t.google)):setTimeout(a,1e3)};this.requestSocialPluginRender=function(o){var n=o instanceof Array?o:[o];n.forEach(function(t){var i=!1,a=!1;return"undefined"==typeof t.querySelector?!1:(i=null!==t.querySelector(".fb-login-button"),a=null!==t.querySelector(".google-login"),i&&(e.facebook=e.facebook.concat(t)),void(a&&(e.google=e.google.concat(t))))}),t.fb=i(),t.google=a()},this.requestSocialPluginRender(arguments[0])},autoCompleteFacebookData:function(){"undefined"!=typeof window.FB&&window.FB.getLoginStatus(function(e){"connected"===e.status&&window.FB.api("/me",{fields:"name,first_name,last_name,email"},function(e){if(e.error)throw new Error("Facebook API Error: "+e.error);o.autoCompleteFormFields({username:e.name||"",email:e.email||"",firstName:e.first_name||"",lastName:e.last_name||""})})})},autoCompleteGoogleData:function(){var e,t;"undefined"!=typeof window.gapi&&"undefined"!=typeof window.gapi.auth2&&(e=window.gapi.auth2.getAuthInstance(),t=e.currentUser.get().getBasicProfile(),"undefined"!=typeof t&&o.autoCompleteFormFields({username:t.getName()||"",email:t.getEmail()||"",firstName:"",lastName:""}))},autoCompleteFormFields:function(e){var i=Array.prototype.slice.call(t.querySelectorAll(".pf-widget-content"));
i.forEach(function(t){Object.keys(e).forEach(function(i){var a=t.querySelector('input[name="'+i+'"]');a&&!a.value&&(a.value=e[i])})})}},n={getData:function(e,t,i){var a=new XMLHttpRequest;a.onreadystatechange=function(){4===a.readyState&&200===a.status?t(a.responseText):4===a.readyState&&i(a.responseText)},a.open("GET",e),a.send()},postData:function(e,t,i,a){var o=new XMLHttpRequest;o.open("POST",e),o.setRequestHeader("Accept","application/json"),o.setRequestHeader("Content-type","application/json"),o.onreadystatechange=function(){4===o.readyState&&200===o.status?i(o.responseText):4===o.readyState&&a(o.responseText)},o.send(t)},reportData:function(e){var t;"object"==typeof jstag&&jstag.send(e),"function"==typeof ga&&(t=e["pf-widget-action"]||e["pf-widget-event"],ga("send","event","Lytics",e["pf-widget-id"]+" : "+t,"",{nonInteraction:!0}))},checkUserSegments:function(e,t){var i,o=a.readCookie("seerid");if(!o)throw new Error("Cannot find SEERID cookie");i=["//api.lytics.io/api/me/",e,"/",o,"?segments=true"].join(""),this.getData(i,function(e){t(JSON.parse(e).data.segments)},function(){t({data:{segments:["all"]}})})},recommendContent:function(e,t,i){var o,n=a.readCookie("seerid");if(!n)throw new Error("Cannot find SEERID cookie");o=["//api.lytics.io/api/me/content/recommend/",e,"/_uids/",n,"?limit=1",t?"&ql="+t:""].join(""),this.getData(o,function(e){var t=JSON.parse(e);i(t.data&&t.data.length>0?t.data[0]:null)},function(){i(null)})}},i=function(){this.version="0.0.2",this.initializePageViews=function(){var e=a.readCookie("PathforaPageView"),t=new Date;t.setDate(t.getDate()+365),a.saveCookie("PathforaPageView",Math.min(~~e,9998)+1,t)},this.initializeWidgets=function(i,a,r){(!t.all||e.atob)&&(o.validateWidgetsObject(i),o.trackTimeOnPage(),r&&(s=JSON.parse(JSON.stringify(l)),o.updateObject(l,r)),i instanceof Array?o.initializeWidgetArray(i,a):(i.common&&(o.initializeWidgetArray(i.common,a),o.updateObject(l,i.common.config)),(i.target||i.exclude)&&n.checkUserSegments(a,function(e){var t,n,s,r,l,d,c,f,p=[],g=!1;if(i.target)for(s=i.target.length,n=0;s>n;n++)t=i.target[n],e&&-1!==e.indexOf(t.segment)&&(p=t.widgets);if(i.exclude)for(f=i.exclude.length,l=0;f>l;l++)if(r=i.exclude[l],e&&-1!==e.indexOf(r.segment))for(d=0;d<p.length;d++)for(c=0;c<r.widgets.length;c++)p[d]===r.widgets[c]&&p.splice(d,1);p.length&&o.initializeWidgetArray(p,a),p.length||g||!i.inverse||o.initializeWidgetArray(i.inverse,a)})))},this.previewWidget=function(e){return e.id=a.generateUniqueId(),o.createWidgetHtml(e)},this.initializeABTesting=function(e){e.forEach(function(e){var t,i=e.type,o=a.readCookie(e.cookieId),n=0;o||(o=Math.random());var s=new Date;for(s.setDate(s.getDate()+365),a.saveCookie(e.cookieId,o,s),t=0;1>t&&(t+=i.groups[n],!(t>=o));)n++;if(e.groups.forEach(function(e,t){e.forEach(function(e){if("undefined"!=typeof e.abTestingGroup)throw new Error("Widget #"+e.config.id+" is defined in more than one AB test.");e.abTestingGroup=t,e.hiddenViaABTests=n===t})}),"undefined"!=typeof u.abTestingGroups[e.id])throw new Error("AB test with ID="+e.id+" has been already defined.");u.abTestingGroups[e.id]=n})},this.Message=function(e){return o.prepareWidget("message",e)},this.Subscription=function(e){return o.prepareWidget("subscription",e)},this.Form=function(e){return o.prepareWidget("form",e)},this.SiteGate=function(e){return o.prepareWidget("sitegate",e)},this.showWidget=function(i){var n,s,r,l;for(s=o.openedWidgets.length,n=0;s>n;n++)if(o.openedWidgets[n]===i)return;if(o.openedWidgets.push(i),o.trackWidgetAction("show",i),r=o.createWidgetHtml(i),i.showSocialLogin&&o.requestSocialPluginRender(r),i.pushDown&&a.addClass(t.querySelector(".pf-push-down"),"opened"),"inline"!==i.config.layout)t.body.appendChild(r);else{if(l=t.querySelector(i.config.position),!l)throw new Error("Inline widget could not be initialized in "+i.config.position);l.appendChild(r)}setTimeout(function(){var e=i.config.onLoad;a.addClass(r,"opened"),"function"==typeof e&&e(c.LOAD,{widget:i,node:r}),"modal"===i.config.layout&&"function"==typeof i.config.onModalOpen&&i.config.onModalOpen(c.MODAL_OPEN,{widget:i})},50),i.displayConditions.hideAfter&&setTimeout(function(){e.pathfora.closeWidget(i.id)},1e3*i.displayConditions.hideAfter)},this.closeWidget=function(e,i){var n,s,r;for(s=o.openedWidgets.length,n=0;s>n;n++)if(o.openedWidgets[n].id===e){i||o.trackWidgetAction("close",o.openedWidgets[n]),o.openedWidgets.splice(n,1);break}if(r=t.getElementById(e),a.removeClass(r,"opened"),a.hasClass(r,"pf-has-push-down")){var l=t.querySelector(".pf-push-down");l&&a.removeClass(l,"opened")}setTimeout(function(){r&&r.parentNode&&r.parentNode.removeChild(r)},500)},this.getData=function(){return u},this.clearAll=function(){var e,i,n=o.openedWidgets,r=o.delayedWidgets;for(n.forEach(function(i){e=t.getElementById(i.id),a.removeClass(e,"opened"),e.parentNode.removeChild(e)}),n.slice(0),i=r.length;i>-1;i--)o.cancelDelayedWidget(r[i]);o.openedWidgets=[],o.initializedWidgets=[],o.removeScrollWatchers(o.watchers),u={pageViews:0,timeSpentOnPage:0,closedWidgets:[],completedActions:[],cancelledActions:[],displayedWidgets:[],abTestingGroups:[],socialNetworks:{}},s&&(l=s)},this.integrateWithFacebook=function(e){var i=function(e){Object.keys(e).forEach(function(t){e[t]=e[t].replace(/<p name="fb-login" hidden><\/p>/gm,d.social.facebookIcon)})};window.fbAsyncInit=function(){window.FB.init({appId:e,xfbml:!0,version:"v2.5",status:!0,cookie:!0})},function(e,t,i){var a,o=e.getElementsByTagName(t)[0];e.getElementById(i)||(a=e.createElement(t),a.id=i,a.src="//connect.facebook.net/en_US/sdk.js",o.parentNode.insertBefore(a,o))}(t,"script","facebook-jssdk"),i(d.form),i(d.sitegate),u.socialNetworks.facebookAppId=e},this.integrateWithGoogle=function(e){var i=(t.querySelector("body"),t.querySelector("head")),a=d.social.googleMeta.replace(/(\{){2}google-clientId(\}){2}/gm,e),o=function(e){Object.keys(e).forEach(function(t,i){e[t]=e[t].replace(/<p name="google-login" hidden><\/p>/gm,d.social.googleIcon.replace(/(\{){2}google-btnId(\}){2}/gm,"g-"+i))})};i.innerHTML+=a,function(){var e,i=t.createElement("script");i.type="text/javascript",i.async=!0,i.src="https://apis.google.com/js/platform.js",e=t.getElementsByTagName("script")[0],e.parentNode.insertBefore(i,e)}(),u.socialNetworks.googleClientID=e,o(d.form),o(d.sitegate)},this.onFacebookSignIn=function(){o.autoCompleteFacebookData()},this.onGoogleSignIn=function(e){o.autoCompleteGoogleData(e)},this.ABTest=function(e){return o.prepareABTest(e)},this.utils=a},m(),e.pathfora=new i,e.pathfora.initializePageViews(),"object"==typeof pfCfg&&n.getData(["https:"===t.location.protocol?"https":"http","://pathfora.parseapp.com/config/",pfCfg.uid,"/",pfCfg.pid].join(""),function(t){var i,a,n,s,r=JSON.parse(t),l=r.widgets,d={};if("undefined"!=typeof r.config.themes)for(s=r.config.themes.length,n=0;s>n;n++)d[r.config.themes[n].name]=r.config.themes[n].colors;for(i={generic:{themes:d}},a=function(e){for(s=e.length,n=0;s>n;n++)e[n]=o.prepareWidget(e[n].type,e[n])},a(l.common),s=l.target.length,n=0;s>n;n++)a(l.target[n].widgets);e.pathfora.initializeWidgets(l,pfCfg.lid,i)})}(window,document);